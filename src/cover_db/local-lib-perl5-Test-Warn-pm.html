<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.20
Devel::Cover is copyright 2001-2012, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: local/lib/perl5/Test/Warn.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">local/lib/perl5/Test/Warn.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">11.9%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1 - 241</td><td colspan="5"></td><td class="s"><pre>=head1 NAME

Test::Warn - Perl extension to test methods for warnings

=head1 SYNOPSIS

&nbsp;&nbsp;use Test::Warn;

&nbsp;&nbsp;warning_is&nbsp;&nbsp;&nbsp;&nbsp;{foo(-dri =&gt; &quot;/&quot;)} &quot;Unknown Parameter &#39;dri&#39;&quot;, &quot;dri != dir gives warning&quot;;
&nbsp;&nbsp;warnings_are&nbsp;&nbsp;{bar(1,1)} [&quot;Width very small&quot;, &quot;Height very small&quot;];

&nbsp;&nbsp;warning_is&nbsp;&nbsp;&nbsp;&nbsp;{add(2,2)} undef, &quot;No warnings for calc 2+2&quot;; # or
&nbsp;&nbsp;warnings_are&nbsp;&nbsp;{add(2,2)} [],&nbsp;&nbsp;&nbsp;&nbsp;&quot;No warnings for calc 2+2&quot;; # what reads better :-)

&nbsp;&nbsp;warning_like&nbsp;&nbsp;{foo(-dri =&gt; &quot;/&quot;)} qr/unknown param/i, &quot;an unknown parameter test&quot;;
&nbsp;&nbsp;warnings_like {bar(1,1)} [qr/width.*small/i, qr/height.*small/i];

&nbsp;&nbsp;warning_is&nbsp;&nbsp;&nbsp;&nbsp;{foo()} {carped =&gt; &quot;didn&#39;t find the right parameters&quot;};
&nbsp;&nbsp;warnings_like {foo()} [qr/undefined/,qr/undefined/,{carped =&gt; qr/no result/i}];

&nbsp;&nbsp;warning_like {foo(undef)}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;uninitialized&#39;;
&nbsp;&nbsp;warning_like {bar(file =&gt; &#39;/etc/passwd&#39;)} &#39;io&#39;;

&nbsp;&nbsp;warning_like {eval q/&quot;$x&quot;; $x;/} 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[qw/void uninitialized/], 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;some warnings at compile time&quot;;

&nbsp;&nbsp;warnings_exist {...} [qr/expected warning/], &quot;Expected warning is thrown&quot;;

=head1 DESCRIPTION

A good style of Perl programming calls for a lot of diverse regression tests.

This module provides a few convenience methods for testing warning based code.

If you are not already familiar with the Test::More manpage 
now would be the time to go take a look.

=head2 FUNCTIONS

=over 4

=item warning_is BLOCK STRING, TEST_NAME

Tests that BLOCK gives the specified warning exactly once.
The test fails if the BLOCK warns more than once or does not warn at all.
If the string is undef, 
then the tests succeeds if the BLOCK doesn&#39;t give any warning.
Another way to say that there are no warnings in the block
is C&lt;warnings_are {foo()} [], &quot;no warnings&quot;&gt;.

If you want to test for a warning given by Carp,
you have to write something like:
C&lt;warning_is {carp &quot;msg&quot;} {carped =E&lt;gt&gt; &#39;msg&#39;}, &quot;Test for a carped warning&quot;&gt;.
The test will fail if a &quot;normal&quot; warning is found instead of a &quot;carped&quot; one.

Note: C&lt;warn &quot;foo&quot;&gt; would print something like C&lt;foo at -e line 1&gt;. 
This method ignores everything after the &quot;at&quot;. Thus to match this warning
you would have to call C&lt;warning_is {warn &quot;foo&quot;} &quot;foo&quot;, &quot;Foo succeeded&quot;&gt;.
If you need to test for a warning at an exactly line,
try something like C&lt;warning_like {warn &quot;foo&quot;} qr/at XYZ.dat line 5/&gt;.

warning_is and warning_are are only aliases to the same method.
So you also could write
C&lt;warning_is {foo()} [], &quot;no warning&quot;&gt; or something similar.
I decided to give two methods the same name to improve readability.

A true value is returned if the test succeeds, false otherwise.

The test name is optional, but recommended.


=item warnings_are BLOCK ARRAYREF, TEST_NAME

Tests to see that BLOCK gives exactly the specified warnings.
The test fails if the warnings from BLOCK are not exactly the ones in ARRAYREF.
If the ARRAYREF is equal to [],
then the test succeeds if the BLOCK doesn&#39;t give any warning.

Please read also the notes to warning_is as these methods are only aliases.

If you want more than one test for carped warnings, try this:
C&lt;warnings_are {carp &quot;c1&quot;; carp &quot;c2&quot;} {carped =&gt; [&#39;c1&#39;,&#39;c2&#39;];&gt; or
C&lt;warnings_are {foo()} [&quot;Warning 1&quot;, {carped =&gt; [&quot;Carp 1&quot;, &quot;Carp 2&quot;]}, &quot;Warning 2&quot;]&gt;.
Note that C&lt;{carped =&gt; ...}&gt; must always be a hash ref.

=item warning_like BLOCK REGEXP, TEST_NAME

Tests that BLOCK gives exactly one warning and it can be matched by
the given regexp.
If the string is undef, 
then the tests succeeds if the BLOCK doesn&#39;t give any warning.

The REGEXP is matched against the whole warning line,
which in general has the form &quot;WARNING at __FILE__ line __LINE__&quot;.
So you can check for a warning in the file Foo.pm on line 5 with
C&lt;warning_like {bar()} qr/at Foo.pm line 5/, &quot;Testname&quot;&gt;.
I don&#39;t know whether it makes sense to do such a test :-(
However, you should be prepared as a matching with &#39;at&#39;, &#39;file&#39;, &#39;\d&#39;
or similar will always pass. 
Think to the qr/^foo/ if you want to test for warning &quot;foo something&quot; in file foo.pl.

You can also write the regexp in a string as &quot;/.../&quot;
instead of using the qr/.../ syntax.
Note that the slashes are important in the string,
as strings without slashes are reserved for warning categories
(to match warning categories as can be seen in the perllexwarn man page).

Similar to C&lt;warning_is&gt;,
you can test for warnings via C&lt;carp&gt; with:
C&lt;warning_like {bar()} {carped =&gt; qr/bar called too early/i};&gt;

Similar to C&lt;warning_is&gt;/C&lt;warnings_are&gt;,
C&lt;warning_like&gt; and C&lt;warnings_like&gt; are only aliases to the same methods.

A true value is returned if the test succeeds, false otherwise.

The test name is optional, but recommended.

=item warning_like BLOCK STRING, TEST_NAME

Tests whether a BLOCK gives exactly one warning of the passed category.
The categories are grouped in a tree,
like it is expressed in perllexwarn.
Also see L&lt;/BUGS AND LIMITATIONS&gt;.


Thanks to the grouping in a tree,
it&#39;s simple possible to test for an &#39;io&#39; warning,
instead for testing for a &#39;closed|exec|layer|newline|pipe|unopened&#39; warning.

Note, that warnings occurring at compile time,
can only be caught in an eval block. So

&nbsp;&nbsp;warning_like {eval q/&quot;$x&quot;; $x;/} 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[qw/void uninitialized/], 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;some warnings at compile time&quot;;

will work,
while it wouldn&#39;t work without the eval.

Note, that it isn&#39;t possible yet,
to test for own categories,
created with warnings::register.

=item warnings_like BLOCK ARRAYREF, TEST_NAME

Tests to see that BLOCK gives exactly the number of the specified warnings
and all the warnings have to match in the defined order to the 
passed regexes.

Please read also the notes to warning_like as these methods are only aliases.

Similar to C&lt;warnings_are&gt;,
you can test for multiple warnings via C&lt;carp&gt;
and for warning categories, too:

&nbsp;&nbsp;warnings_like {foo()} 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[qr/bar warning/,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr/bar warning/,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{carped =&gt; qr/bar warning/i},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;io&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;I hope, you&#39;ll never have to write a test for so many warnings :-)&quot;;

=item warnings_exist BLOCK STRING|ARRAYREF, TEST_NAME

Same as warning_like, but will warn() all warnings that do not match the supplied regex/category,
instead of registering an error. Use this test when you just want to make sure that specific
warnings were generated, and couldn&#39;t care less if other warnings happened in the same block
of code.

&nbsp;&nbsp;warnings_exist {...} [qr/expected warning/], &quot;Expected warning is thrown&quot;;

&nbsp;&nbsp;warnings_exist {...} [&#39;uninitialized&#39;], &quot;Expected warning is thrown&quot;;

=back

=head2 EXPORT

C&lt;warning_is&gt;,
C&lt;warnings_are&gt;,
C&lt;warning_like&gt;,
C&lt;warnings_like&gt;,
C&lt;warnings_exist&gt; by default.

=head1 BUGS AND LIMITATIONS

Category check is done as qr/category_name/. In some case this works, like for
category &#39;uninitialized&#39;. For &#39;utf8&#39; it does not work. Perl does not have a list
of warnings, so it is not possible to generate one for Test::Warn.
If you want to add a warning to a category, send a pull request. Modifications
should be done to %warnings_in_category. You should look into perl source to check
how warning is looking exactly.

Please note that warnings with newlines inside are making a lot of trouble.
The only sensible way to handle them is to use are the C&lt;warning_like&gt; or
C&lt;warnings_like&gt; methods. Background for these problems is that there is no
really secure way to distinguish between warnings with newlines and a tracing
stacktrace.

If a method has it&#39;s own warn handler,
overwriting C&lt;$SIG{__WARN__}&gt;,
my test warning methods won&#39;t get these warnings.

The C&lt;warning_like BLOCK CATEGORY, TEST_NAME&gt; method isn&#39;t extremely tested.
Please use this calling style with higher attention and
tell me if you find a bug.

=head1 TODO

Improve this documentation.

The code has some parts doubled - especially in the test scripts.
This is really awkward and must be changed.

Please feel free to suggest improvements.

=head1 SEE ALSO

Have a look to the similar modules: L&lt;Test::Exception&gt;, L&lt;Test::Trap&gt;.

=head1 THANKS

Many thanks to Adrian Howard, chromatic and Michael G. Schwern,
who have given me a lot of ideas.

=head1 AUTHOR

Janek Schleicher, E&lt;lt&gt;bigj AT kamelfreund.deE&lt;gt&gt;

=head1 COPYRIGHT AND LICENSE

Copyright 2002 by Janek Schleicher

Copyright 2007-2014 by Alexandr Ciornii, L&lt;http://chorny.net/&gt;

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself. 

=cut</pre></td></tr>
<tr><td class="h">242</td><td colspan="6"></td></tr><tr><td class="h">243</td><td colspan="6"></td></tr><tr><td class="h">244</td><td></td><td></td><td></td><td></td><td></td><td class="s">package Test::Warn;</td></tr>
<tr><td class="h">245</td><td colspan="6"></td></tr><tr><td class="h">246</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L246">6</a></div></td><td><div>48</div><div>9</div></td><td class="s">use 5.006;</td></tr>
<tr><td class="h">247</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L247">6</a></div></td><td><div>9</div><div>5</div><div>69</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">248</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L248">6</a></div></td><td><div>12</div><div>4</div><div>134</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">249</td><td colspan="6"></td></tr><tr><td class="h">250</td><td></td><td></td><td></td><td></td><td></td><td class="s">#use Array::Compare;</td></tr>
<tr><td class="h">251</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L251">6</a></div></td><td><div>132</div><div>60</div><div>35</div></td><td class="s">use Sub::Uplevel 0.12;</td></tr>
<tr><td class="h">252</td><td colspan="6"></td></tr><tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;0.30&#39;;</td></tr>
<tr><td class="h">254</td><td colspan="6"></td></tr><tr><td class="h">255</td><td></td><td></td><td></td><td></td><td></td><td class="s">require Exporter;</td></tr>
<tr><td class="h">256</td><td colspan="6"></td></tr><tr><td class="h">257</td><td></td><td></td><td></td><td></td><td></td><td class="s">our @ISA = qw(Exporter);</td></tr>
<tr><td class="h">258</td><td colspan="6"></td></tr><tr><td class="h">259</td><td></td><td></td><td></td><td></td><td></td><td class="s">our %EXPORT_TAGS = ( &#39;all&#39; =&gt; [ qw(</td></tr>
<tr><td class="h">260</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@EXPORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">261</td><td></td><td></td><td></td><td></td><td></td><td class="s">) ] );</td></tr>
<tr><td class="h">262</td><td colspan="6"></td></tr><tr><td class="h">263</td><td></td><td></td><td></td><td></td><td></td><td class="s">our @EXPORT_OK = ( @{ $EXPORT_TAGS{&#39;all&#39;} } );</td></tr>
<tr><td class="h">264</td><td colspan="6"></td></tr><tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td class="s">our @EXPORT = qw(</td></tr>
<tr><td class="h">266</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;warning_is&nbsp;&nbsp;&nbsp;warnings_are</td></tr>
<tr><td class="h">267</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;warning_like warnings_like</td></tr>
<tr><td class="h">268</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;warnings_exist</td></tr>
<tr><td class="h">269</td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">270</td><td colspan="6"></td></tr><tr><td class="h">271</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L271">6</a></div></td><td><div>11</div><div>5</div><div>106</div></td><td class="s">use Test::Builder;</td></tr>
<tr><td class="h">272</td><td></td><td></td><td></td><td></td><td></td><td class="s">my $Tester = Test::Builder-&gt;new;</td></tr>
<tr><td class="h">273</td><td colspan="6"></td></tr><tr><td class="h">274</td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">275</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L275">6</a></div></td><td><div>9</div><div>4</div><div>3394</div></td><td class="s">no warnings &#39;once&#39;;</td></tr>
<tr><td class="h">276</td><td></td><td></td><td></td><td></td><td></td><td class="s">*warning_is = *warnings_are;</td></tr>
<tr><td class="h">277</td><td></td><td></td><td></td><td></td><td></td><td class="s">*warning_like = *warnings_like;</td></tr>
<tr><td class="h">278</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">279</td><td colspan="6"></td></tr><tr><td class="h">280</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warnings_are (&amp;$;$) {</td></tr>
<tr><td class="h">281</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L281">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">282</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L282">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @exp_warning = map {_canonical_exp_warning($_)}</td></tr>
<tr><td class="h">283</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_to_array_if_necessary( shift() || [] );</td></tr>
<tr><td class="h">284</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $testname&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">285</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @got_warning = ();</td></tr>
<tr><td class="h">286</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $SIG{__WARN__} = sub {</td></tr>
<tr><td class="h">287</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L287">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($called_from) = caller(0);&nbsp;&nbsp;# to find out Carping methods</td></tr>
<tr><td class="h">288</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @got_warning, _canonical_got_warning($called_from, shift());</td></tr>
<tr><td class="h">289</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">290</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;uplevel 1,$block;</td></tr>
<tr><td class="h">291</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = _cmp_is( \@got_warning, \@exp_warning );</td></tr>
<tr><td class="h">292</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;ok( $ok, $testname );</td></tr>
<tr><td class="h">293</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L293">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ok or _diag_found_warning(@got_warning),</td></tr>
<tr><td class="h">294</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_diag_exp_warning(@exp_warning);</td></tr>
<tr><td class="h">295</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">296</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">297</td><td colspan="6"></td></tr><tr><td class="h">298</td><td colspan="6"></td></tr><tr><td class="h">299</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warnings_like (&amp;$;$) {</td></tr>
<tr><td class="h">300</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L300">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">301</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L301">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @exp_warning = map {_canonical_exp_warning($_)}</td></tr>
<tr><td class="h">302</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_to_array_if_necessary( shift() || [] );</td></tr>
<tr><td class="h">303</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $testname&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">304</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @got_warning = ();</td></tr>
<tr><td class="h">305</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $SIG{__WARN__} = sub {</td></tr>
<tr><td class="h">306</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L306">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($called_from) = caller(0);&nbsp;&nbsp;# to find out Carping methods</td></tr>
<tr><td class="h">307</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @got_warning, _canonical_got_warning($called_from, shift());</td></tr>
<tr><td class="h">308</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">309</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;uplevel 1,$block;</td></tr>
<tr><td class="h">310</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = _cmp_like( \@got_warning, \@exp_warning );</td></tr>
<tr><td class="h">311</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;ok( $ok, $testname );</td></tr>
<tr><td class="h">312</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L312">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ok or _diag_found_warning(@got_warning),</td></tr>
<tr><td class="h">313</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_diag_exp_warning(@exp_warning);</td></tr>
<tr><td class="h">314</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">315</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">316</td><td colspan="6"></td></tr><tr><td class="h">317</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warnings_exist (&amp;$;$) {</td></tr>
<tr><td class="h">318</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L318">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">319</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L319">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @exp_warning = map {_canonical_exp_warning($_)}</td></tr>
<tr><td class="h">320</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_to_array_if_necessary( shift() || [] );</td></tr>
<tr><td class="h">321</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $testname&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">322</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @got_warning = ();</td></tr>
<tr><td class="h">323</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $SIG{__WARN__} = sub {</td></tr>
<tr><td class="h">324</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L324">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($called_from) = caller(0);&nbsp;&nbsp;# to find out Carping methods</td></tr>
<tr><td class="h">325</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $wrn_text=shift;</td></tr>
<tr><td class="h">326</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $wrn_rec=_canonical_got_warning($called_from, $wrn_text);</td></tr>
<tr><td class="h">327</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $wrn (@exp_warning) {</td></tr>
<tr><td class="h">328</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L328">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_cmp_got_to_exp_warning_like($wrn_rec,$wrn)) {</td></tr>
<tr><td class="h">329</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @got_warning, $wrn_rec;</td></tr>
<tr><td class="h">330</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">331</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">332</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">333</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn $wrn_text;</td></tr>
<tr><td class="h">334</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">335</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;uplevel 1,$block;</td></tr>
<tr><td class="h">336</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = _cmp_like( \@got_warning, \@exp_warning );</td></tr>
<tr><td class="h">337</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;ok( $ok, $testname );</td></tr>
<tr><td class="h">338</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L338">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ok or _diag_found_warning(@got_warning),</td></tr>
<tr><td class="h">339</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_diag_exp_warning(@exp_warning);</td></tr>
<tr><td class="h">340</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">341</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">342</td><td colspan="6"></td></tr><tr><td class="h">343</td><td colspan="6"></td></tr><tr><td class="h">344</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _to_array_if_necessary {</td></tr>
<tr><td class="h">345</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L345">0</a></div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L345">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return (ref($_[0]) eq &#39;ARRAY&#39;) ? @{$_[0]} : ($_[0]);</td></tr>
<tr><td class="h">346</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">347</td><td colspan="6"></td></tr><tr><td class="h">348</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _canonical_got_warning {</td></tr>
<tr><td class="h">349</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L349">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($called_from, $msg) = @_;</td></tr>
<tr><td class="h">350</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L350">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $warn_kind = $called_from eq &#39;Carp&#39; ? &#39;carped&#39; : &#39;warn&#39;;</td></tr>
<tr><td class="h">351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @warning_stack = split /\n/, $msg;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# some stuff of uplevel is included</td></tr>
<tr><td class="h">352</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return {$warn_kind =&gt; $warning_stack[0]}; # return only the real message</td></tr>
<tr><td class="h">353</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">354</td><td colspan="6"></td></tr><tr><td class="h">355</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _canonical_exp_warning {</td></tr>
<tr><td class="h">356</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L356">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($exp) = @_;</td></tr>
<tr><td class="h">357</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L357">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (ref($exp) eq &#39;HASH&#39;) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# could be {carped =&gt; ...}</td></tr>
<tr><td class="h">358</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L358">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $to_carp = $exp-&gt;{carped} or return; # undefined message are ignored</td></tr>
<tr><td class="h">359</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (ref($to_carp) eq &#39;ARRAY&#39;)&nbsp;&nbsp;# is {carped =&gt; [ ..., ...] }</td></tr>
<tr><td class="h">360</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L360">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? map({ {carped =&gt; $_} } grep {defined $_} @$to_carp)</td></tr>
<tr><td class="h">361</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: +{carped =&gt; $to_carp};</td></tr>
<tr><td class="h">362</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">363</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return {warn =&gt; $exp};</td></tr>
<tr><td class="h">364</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">365</td><td colspan="6"></td></tr><tr><td class="h">366</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _cmp_got_to_exp_warning {</td></tr>
<tr><td class="h">367</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L367">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($got_kind, $got_msg) = %{ shift() };</td></tr>
<tr><td class="h">368</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($exp_kind, $exp_msg) = %{ shift() };</td></tr>
<tr><td class="h">369</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L369">0</a></div></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L369">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0 if ($got_kind eq &#39;warn&#39;) &amp;&amp; ($exp_kind eq &#39;carped&#39;);</td></tr>
<tr><td class="h">370</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cmp = $got_msg =~ /^\Q$exp_msg\E at .+ line \d+\.?$/;</td></tr>
<tr><td class="h">371</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $cmp;</td></tr>
<tr><td class="h">372</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">373</td><td colspan="6"></td></tr><tr><td class="h">374</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _cmp_got_to_exp_warning_like {</td></tr>
<tr><td class="h">375</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L375">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($got_kind, $got_msg) = %{ shift() };</td></tr>
<tr><td class="h">376</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($exp_kind, $exp_msg) = %{ shift() };</td></tr>
<tr><td class="h">377</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L377">0</a></div></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L377">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0 if ($got_kind eq &#39;warn&#39;) &amp;&amp; ($exp_kind eq &#39;carped&#39;);</td></tr>
<tr><td class="h">378</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L378">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $re = $Tester-&gt;maybe_regex($exp_msg)) { #qr// or &#39;//&#39;</td></tr>
<tr><td class="h">379</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cmp = $got_msg =~ /$re/;</td></tr>
<tr><td class="h">380</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $cmp;</td></tr>
<tr><td class="h">381</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">382</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Test::Warn::Categorization::warning_like_category($got_msg,$exp_msg);</td></tr>
<tr><td class="h">383</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">384</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">385</td><td colspan="6"></td></tr><tr><td class="h">386</td><td colspan="6"></td></tr><tr><td class="h">387</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _cmp_is {</td></tr>
<tr><td class="h">388</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L388">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @got&nbsp;&nbsp;= @{ shift() };</td></tr>
<tr><td class="h">389</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @exp&nbsp;&nbsp;= @{ shift() };</td></tr>
<tr><td class="h">390</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L390">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;scalar @got == scalar @exp or return 0;</td></tr>
<tr><td class="h">391</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cmp = 1;</td></tr>
<tr><td class="h">392</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L392">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$cmp &amp;&amp;= _cmp_got_to_exp_warning($got[$_],$exp[$_]) for (0 .. $#got);</td></tr>
<tr><td class="h">393</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $cmp;</td></tr>
<tr><td class="h">394</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">395</td><td colspan="6"></td></tr><tr><td class="h">396</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _cmp_like {</td></tr>
<tr><td class="h">397</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L397">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @got&nbsp;&nbsp;= @{ shift() };</td></tr>
<tr><td class="h">398</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @exp&nbsp;&nbsp;= @{ shift() };</td></tr>
<tr><td class="h">399</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L399">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;scalar @got == scalar @exp or return 0;</td></tr>
<tr><td class="h">400</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cmp = 1;</td></tr>
<tr><td class="h">401</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--condition.html#L401">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$cmp &amp;&amp;= _cmp_got_to_exp_warning_like($got[$_],$exp[$_]) for (0 .. $#got);</td></tr>
<tr><td class="h">402</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $cmp;</td></tr>
<tr><td class="h">403</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">404</td><td colspan="6"></td></tr><tr><td class="h">405</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _diag_found_warning {</td></tr>
<tr><td class="h">406</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L406">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach (@_) {</td></tr>
<tr><td class="h">407</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L407">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref($_) eq &#39;HASH&#39;) {</td></tr>
<tr><td class="h">408</td><td><div class="c0">0</div><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L408">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${$_}{carped} ? $Tester-&gt;diag(&quot;found carped warning: ${$_}{carped}&quot;)</td></tr>
<tr><td class="h">409</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $Tester-&gt;diag(&quot;found warning: ${$_}{warn}&quot;);</td></tr>
<tr><td class="h">410</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">411</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( &quot;found warning: $_&quot; );</td></tr>
<tr><td class="h">412</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">413</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">414</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L414">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( &quot;didn&#39;t find a warning&quot; ) unless @_;</td></tr>
<tr><td class="h">415</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">416</td><td colspan="6"></td></tr><tr><td class="h">417</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _diag_exp_warning {</td></tr>
<tr><td class="h">418</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L418">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach (@_) {</td></tr>
<tr><td class="h">419</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L419">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref($_) eq &#39;HASH&#39;) {</td></tr>
<tr><td class="h">420</td><td><div class="c0">0</div><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L420">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${$_}{carped} ? $Tester-&gt;diag(&quot;expected to find carped warning: ${$_}{carped}&quot;)</td></tr>
<tr><td class="h">421</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $Tester-&gt;diag(&quot;expected to find warning: ${$_}{warn}&quot;);</td></tr>
<tr><td class="h">422</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">423</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( &quot;expected to find warning: $_&quot; );</td></tr>
<tr><td class="h">424</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">425</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">426</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L426">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( &quot;didn&#39;t expect to find a warning&quot; ) unless @_;</td></tr>
<tr><td class="h">427</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">428</td><td colspan="6"></td></tr><tr><td class="h">429</td><td></td><td></td><td></td><td></td><td></td><td class="s">package Test::Warn::Categorization;</td></tr>
<tr><td class="h">430</td><td colspan="6"></td></tr><tr><td class="h">431</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L431">6</a></div></td><td><div>18</div><div>5</div><div>839</div></td><td class="s">use Carp;</td></tr>
<tr><td class="h">432</td><td colspan="6"></td></tr><tr><td class="h">433</td><td></td><td></td><td></td><td></td><td></td><td class="s">my $bits = \%warnings::Bits;</td></tr>
<tr><td class="h">434</td><td></td><td></td><td></td><td></td><td></td><td class="s">my @warnings = sort grep {</td></tr>
<tr><td class="h">435</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;my $warn_bits = $bits-&gt;{$_};</td></tr>
<tr><td class="h">436</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;#!grep { $_ ne $warn_bits &amp;&amp; ($_ &amp; $warn_bits) eq $_ } values %$bits;</td></tr>
<tr><td class="h">437</td><td></td><td></td><td></td><td></td><td></td><td class="s">} keys %$bits;</td></tr>
<tr><td class="h">438</td><td colspan="6"></td></tr><tr><td class="h">439</td><td></td><td></td><td></td><td></td><td></td><td class="s">my %warnings_in_category = (</td></tr>
<tr><td class="h">440</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&#39;utf8&#39; =&gt; [&#39;Wide character in \w+\b&#39;,],</td></tr>
<tr><td class="h">441</td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">442</td><td colspan="6"></td></tr><tr><td class="h">443</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _warning_category_regexp {</td></tr>
<tr><td class="h">444</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L444">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $category = shift;</td></tr>
<tr><td class="h">445</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L445">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $category_bits = $bits-&gt;{$category} or return;</td></tr>
<tr><td class="h">446</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @category_warnings</td></tr>
<tr><td class="h">447</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= grep { ($bits-&gt;{$_} &amp; $category_bits) eq $bits-&gt;{$_} } @warnings;</td></tr>
<tr><td class="h">448</td><td colspan="6"></td></tr><tr><td class="h">449</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @list = </td></tr>
<tr><td class="h">450</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L450">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { exists $warnings_in_category{$_}? (@{ $warnings_in_category{$_}}) : ($_) }</td></tr>
<tr><td class="h">451</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@category_warnings;</td></tr>
<tr><td class="h">452</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $re = join &quot;|&quot;, @list;</td></tr>
<tr><td class="h">453</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return qr/$re/;</td></tr>
<tr><td class="h">454</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">455</td><td colspan="6"></td></tr><tr><td class="h">456</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warning_like_category {</td></tr>
<tr><td class="h">457</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Warn-pm--subroutine.html#L457">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($warning, $category) = @_;</td></tr>
<tr><td class="h">458</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Warn-pm--branch.html#L458">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $re = _warning_category_regexp($category) or </td></tr>
<tr><td class="h">459</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carp(&quot;Unknown warning category &#39;$category&#39;&quot;),return;</td></tr>
<tr><td class="h">460</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = $warning =~ /$re/;</td></tr>
<tr><td class="h">461</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">462</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">463</td><td colspan="6"></td></tr><tr><td class="h">464</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
