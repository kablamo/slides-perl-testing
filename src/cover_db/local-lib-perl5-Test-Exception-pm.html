<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.20
Devel::Cover is copyright 2001-2012, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: local/lib/perl5/Test/Exception.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">local/lib/perl5/Test/Exception.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">23.4%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L1">6</a></div></td><td><div>11</div><div>5</div><div>88</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">2</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L2">6</a></div></td><td><div>7</div><div>5</div><div>75</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">3</td><td colspan="6"></td></tr><tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td class="s">package Test::Exception;</td></tr>
<tr><td class="h">5</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L5">6</a></div></td><td><div>9</div><div>4</div><div>56</div></td><td class="s">use Test::Builder;</td></tr>
<tr><td class="h">6</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L6">6</a></div></td><td><div>738</div><div>6</div><div>13</div></td><td class="s">use Sub::Uplevel qw( uplevel );</td></tr>
<tr><td class="h">7</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L7">6</a></div></td><td><div>16</div><div>5</div><div>1021</div></td><td class="s">use base qw( Exporter );</td></tr>
<tr><td class="h">8</td><td colspan="6"></td></tr><tr><td class="h">9</td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;0.32&#39;;</td></tr>
<tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td class="s">our @EXPORT = qw(dies_ok lives_ok throws_ok lives_and);</td></tr>
<tr><td class="h">11</td><td colspan="6"></td></tr><tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s">my $Tester = Test::Builder-&gt;new;</td></tr>
<tr><td class="h">13</td><td colspan="6"></td></tr><tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub import {</td></tr>
<tr><td class="h">15</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L15">6</a></div></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">16</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L16">50</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( @_ ) {</td></tr>
<tr><td class="h">17</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $package = caller;</td></tr>
<tr><td class="h">18</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;exported_to( $package );</td></tr>
<tr><td class="h">19</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;plan( @_ );</td></tr>
<tr><td class="h">20</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">21</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>641</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;export_to_level( 1, $self, $_ ) foreach @EXPORT;</td></tr>
<tr><td class="h">22</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">23</td><td colspan="6"></td></tr><tr><td class="h">24 - 83</td><td colspan="5"></td><td class="s"><pre>=head1 NAME

Test::Exception - Test exception based code

=head1 SYNOPSIS

&nbsp;&nbsp;use Test::More tests =&gt; 5;
&nbsp;&nbsp;use Test::Exception;

&nbsp;&nbsp;# or if you don&#39;t need Test::More

&nbsp;&nbsp;use Test::Exception tests =&gt; 5;

&nbsp;&nbsp;# then...

&nbsp;&nbsp;# Check that the stringified exception matches given regex
&nbsp;&nbsp;throws_ok { $foo-&gt;method } qr/division by zero/, &#39;zero caught okay&#39;;

&nbsp;&nbsp;# Check an exception of the given class (or subclass) is thrown
&nbsp;&nbsp;throws_ok { $foo-&gt;method } &#39;Error::Simple&#39;, &#39;simple error thrown&#39;;
&nbsp;&nbsp;
&nbsp;&nbsp;# all Test::Exceptions subroutines are guaranteed to preserve the state 
&nbsp;&nbsp;# of $@ so you can do things like this after throws_ok and dies_ok
&nbsp;&nbsp;like $@, &#39;what the stringified exception should look like&#39;;

&nbsp;&nbsp;# Check that something died - we do not care why
&nbsp;&nbsp;dies_ok { $foo-&gt;method } &#39;expecting to die&#39;;

&nbsp;&nbsp;# Check that something did not die
&nbsp;&nbsp;lives_ok { $foo-&gt;method } &#39;expecting to live&#39;;

&nbsp;&nbsp;# Check that a test runs without an exception
&nbsp;&nbsp;lives_and { is $foo-&gt;method, 42 } &#39;method is 42&#39;;
&nbsp;&nbsp;
&nbsp;&nbsp;# or if you don&#39;t like prototyped functions
&nbsp;&nbsp;
&nbsp;&nbsp;throws_ok( sub { $foo-&gt;method }, qr/division by zero/,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;zero caught okay&#39; );
&nbsp;&nbsp;throws_ok( sub { $foo-&gt;method }, &#39;Error::Simple&#39;, 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;simple error thrown&#39; );
&nbsp;&nbsp;dies_ok( sub { $foo-&gt;method }, &#39;expecting to die&#39; );
&nbsp;&nbsp;lives_ok( sub { $foo-&gt;method }, &#39;expecting to live&#39; );
&nbsp;&nbsp;lives_and( sub { is $foo-&gt;method, 42 }, &#39;method is 42&#39; );


=head1 DESCRIPTION

This module provides a few convenience methods for testing exception based code. It is built with 
L&lt;Test::Builder&gt; and plays happily with L&lt;Test::More&gt; and friends.

If you are not already familiar with L&lt;Test::More&gt; now would be the time to go take a look.

You can specify the test plan when you C&lt;use Test::Exception&gt; in the same way as C&lt;use Test::More&gt;.
See L&lt;Test::More&gt; for details.

NOTE: Test::Exception only checks for exceptions. It will ignore other methods of stopping 
program execution - including exit(). If you have an exit() in evalled code Test::Exception
will not catch this with any of its testing functions.

=cut</pre></td></tr>
<tr><td class="h">84</td><td colspan="6"></td></tr><tr><td class="h">85</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _quiet_caller (;$) { ## no critic Prototypes</td></tr>
<tr><td class="h">86</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L86">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $height = $_[0];</td></tr>
<tr><td class="h">87</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$height++;</td></tr>
<tr><td class="h">88</td><td colspan="6"></td></tr><tr><td class="h">89</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L89">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( CORE::caller() eq &#39;DB&#39; ) {</td></tr>
<tr><td class="h">90</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# passthrough the @DB::args trick</td></tr>
<tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package DB;</td></tr>
<tr><td class="h">92</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L92">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( wantarray ) {</td></tr>
<tr><td class="h">93</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L93">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( !@_ ) {</td></tr>
<tr><td class="h">94</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (CORE::caller($height))[0..2];</td></tr>
<tr><td class="h">95</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">96</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If we got here, we are within a Test::Exception test, and</td></tr>
<tr><td class="h">98</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# something is producing a stacktrace. In case this is a full</td></tr>
<tr><td class="h">99</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# trace (i.e. confess() ), we have to make sure that the sub</td></tr>
<tr><td class="h">100</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# args are not visible. If we do not do this, and the test in</td></tr>
<tr><td class="h">101</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# question is throws_ok() with a regex, it will end up matching</td></tr>
<tr><td class="h">102</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# against itself in the args to throws_ok().</td></tr>
<tr><td class="h">103</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">104</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# While it is possible (and maybe wise), to test if we are</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# indeed running under throws_ok (by crawling the stack right</td></tr>
<tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# up from here), the old behavior of Test::Exception was to</td></tr>
<tr><td class="h">107</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# simply obliterate @DB::args altogether in _quiet_caller, so</td></tr>
<tr><td class="h">108</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# we are just preserving the behavior to avoid surprises</td></tr>
<tr><td class="h">109</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">110</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @frame_info = CORE::caller($height);</td></tr>
<tr><td class="h">111</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@DB::args = ();</td></tr>
<tr><td class="h">112</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @frame_info;</td></tr>
<tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">114</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">115</td><td colspan="6"></td></tr><tr><td class="h">116</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# fallback if nothing above returns</td></tr>
<tr><td class="h">117</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return CORE::caller($height);</td></tr>
<tr><td class="h">118</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">119</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">120</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L120">0</a></div></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--condition.html#L120">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( wantarray and !@_ ) {</td></tr>
<tr><td class="h">121</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (CORE::caller($height))[0..2];</td></tr>
<tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">124</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return CORE::caller($height);</td></tr>
<tr><td class="h">125</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">126</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">127</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">128</td><td colspan="6"></td></tr><tr><td class="h">129</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _try_as_caller {</td></tr>
<tr><td class="h">130</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L130">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $coderef = shift;</td></tr>
<tr><td class="h">131</td><td colspan="6"></td></tr><tr><td class="h">132</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# local works here because Sub::Uplevel has already overridden caller</td></tr>
<tr><td class="h">133</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local *CORE::GLOBAL::caller;</td></tr>
<tr><td class="h">134</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L134">6</a></div></td><td><div>17</div><div>5</div><div>1471</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{ no warnings &#39;redefine&#39;; *CORE::GLOBAL::caller = \&amp;_quiet_caller; }</td></tr>
<tr><td class="h">135</td><td colspan="6"></td></tr><tr><td class="h">136</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;eval { uplevel 3, $coderef };</td></tr>
<tr><td class="h">137</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $@;</td></tr>
<tr><td class="h">138</td><td></td><td></td><td></td><td></td><td></td><td class="s">};</td></tr>
<tr><td class="h">139</td><td colspan="6"></td></tr><tr><td class="h">140</td><td colspan="6"></td></tr><tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _is_exception {</td></tr>
<tr><td class="h">142</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L142">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $exception = shift;</td></tr>
<tr><td class="h">143</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--condition.html#L143">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ref $exception || $exception ne &#39;&#39;;</td></tr>
<tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td class="s">};</td></tr>
<tr><td class="h">145</td><td colspan="6"></td></tr><tr><td class="h">146</td><td colspan="6"></td></tr><tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _exception_as_string {</td></tr>
<tr><td class="h">148</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L148">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $prefix, $exception ) = @_;</td></tr>
<tr><td class="h">149</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L149">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$prefix normal exit&quot; unless _is_exception( $exception );</td></tr>
<tr><td class="h">150</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $class = ref $exception;</td></tr>
<tr><td class="h">151</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L151">0</a></div></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--condition.html#L151">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$exception = &quot;$class ($exception)&quot; </td></tr>
<tr><td class="h">152</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $class &amp;&amp; &quot;$exception&quot; !~ m/^\Q$class/;</td></tr>
<tr><td class="h">153</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;chomp $exception;</td></tr>
<tr><td class="h">154</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$prefix $exception&quot;;</td></tr>
<tr><td class="h">155</td><td></td><td></td><td></td><td></td><td></td><td class="s">};</td></tr>
<tr><td class="h">156</td><td colspan="6"></td></tr><tr><td class="h">157</td><td colspan="6"></td></tr><tr><td class="h">158 - 206</td><td colspan="5"></td><td class="s"><pre>=over 4

=item B&lt;throws_ok&gt;

Tests to see that a specific exception is thrown. throws_ok() has two forms: 

&nbsp;&nbsp;throws_ok BLOCK REGEX, TEST_DESCRIPTION
&nbsp;&nbsp;throws_ok BLOCK CLASS, TEST_DESCRIPTION

In the first form the test passes if the stringified exception matches the give regular expression. For example:

&nbsp;&nbsp;&nbsp;&nbsp;throws_ok { read_file( &#39;unreadable&#39; ) } qr/No file/, &#39;no file&#39;;

If your perl does not support C&lt;qr//&gt; you can also pass a regex-like string, for example:

&nbsp;&nbsp;&nbsp;&nbsp;throws_ok { read_file( &#39;unreadable&#39; ) } &#39;/No file/&#39;, &#39;no file&#39;;

The second form of throws_ok() test passes if the exception is of the same class as the one supplied, or a subclass of that class. For example:

&nbsp;&nbsp;&nbsp;&nbsp;throws_ok { $foo-&gt;bar } &quot;Error::Simple&quot;, &#39;simple error&#39;;

Will only pass if the C&lt;bar&gt; method throws an Error::Simple exception, or a subclass of an Error::Simple exception.

You can get the same effect by passing an instance of the exception you want to look for. The following is equivalent to the previous example:

&nbsp;&nbsp;&nbsp;&nbsp;my $SIMPLE = Error::Simple-&gt;new;
&nbsp;&nbsp;&nbsp;&nbsp;throws_ok { $foo-&gt;bar } $SIMPLE, &#39;simple error&#39;;

Should a throws_ok() test fail it produces appropriate diagnostic messages. For example:

&nbsp;&nbsp;&nbsp;&nbsp;not ok 3 - simple error
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Failed test (test.t at line 48)
&nbsp;&nbsp;&nbsp;&nbsp;# expecting: Error::Simple exception
&nbsp;&nbsp;&nbsp;&nbsp;# found: normal exit

Like all other Test::Exception functions you can avoid prototypes by passing a subroutine explicitly:

&nbsp;&nbsp;&nbsp;&nbsp;throws_ok( sub {$foo-&gt;bar}, &quot;Error::Simple&quot;, &#39;simple error&#39; );

A true value is returned if the test succeeds, false otherwise. On exit $@ is guaranteed to be the cause of death (if any).

A description of the exception being checked is used if no optional test description is passed.

NOTE: Rememeber when you C&lt;die $string_without_a_trailing_newline&gt; perl will 
automatically add the current script line number, input line number and a newline. This will
form part of the string that throws_ok regular expressions match against.


=cut</pre></td></tr>
<tr><td class="h">207</td><td colspan="6"></td></tr><tr><td class="h">208</td><td colspan="6"></td></tr><tr><td class="h">209</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub throws_ok (&amp;$;$) {</td></tr>
<tr><td class="h">210</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L210">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $coderef, $expecting, $description ) = @_;</td></tr>
<tr><td class="h">211</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L211">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless (defined $expecting) {</td></tr>
<tr><td class="h">212</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require Carp;</td></tr>
<tr><td class="h">213</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Carp::croak( &quot;throws_ok: must pass exception class/object or regex&quot; ); </td></tr>
<tr><td class="h">214</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">215</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L215">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$description = _exception_as_string( &quot;threw&quot;, $expecting )</td></tr>
<tr><td class="h">216</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless defined $description;</td></tr>
<tr><td class="h">217</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $exception = _try_as_caller( $coderef );</td></tr>
<tr><td class="h">218</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $regex = $Tester-&gt;maybe_regex( $expecting );</td></tr>
<tr><td class="h">219</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = $regex </td></tr>
<tr><td class="h">220</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? ( $exception =~ m/$regex/ ) </td></tr>
<tr><td class="h">221</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L221">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: eval { </td></tr>
<tr><td class="h">222</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L222">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$exception-&gt;isa( ref $expecting ? ref $expecting : $expecting ) </td></tr>
<tr><td class="h">223</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">224</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;ok( $ok, $description );</td></tr>
<tr><td class="h">225</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L225">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless ( $ok ) {</td></tr>
<tr><td class="h">226</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( _exception_as_string( &quot;expecting:&quot;, $expecting ) );</td></tr>
<tr><td class="h">227</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( _exception_as_string( &quot;found:&quot;, $exception ) );</td></tr>
<tr><td class="h">228</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">229</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ = $exception;</td></tr>
<tr><td class="h">230</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">231</td><td></td><td></td><td></td><td></td><td></td><td class="s">};</td></tr>
<tr><td class="h">232</td><td colspan="6"></td></tr><tr><td class="h">233</td><td colspan="6"></td></tr><tr><td class="h">234 - 254</td><td colspan="5"></td><td class="s"><pre>=item B&lt;dies_ok&gt;

Checks that a piece of code dies, rather than returning normally. For example:

&nbsp;&nbsp;&nbsp;&nbsp;sub div {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $a, $b ) = @_;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $a / $b;
&nbsp;&nbsp;&nbsp;&nbsp;};

&nbsp;&nbsp;&nbsp;&nbsp;dies_ok { div( 1, 0 ) } &#39;divide by zero detected&#39;;

&nbsp;&nbsp;&nbsp;&nbsp;# or if you don&#39;t like prototypes
&nbsp;&nbsp;&nbsp;&nbsp;dies_ok( sub { div( 1, 0 ) }, &#39;divide by zero detected&#39; );

A true value is returned if the test succeeds, false otherwise. On exit $@ is guaranteed to be the cause of death (if any).

Remember: This test will pass if the code dies for any reason. If you care about the reason it might be more sensible to write a more specific test using throws_ok().

The test description is optional, but recommended. 

=cut</pre></td></tr>
<tr><td class="h">255</td><td colspan="6"></td></tr><tr><td class="h">256</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub dies_ok (&amp;;$) {</td></tr>
<tr><td class="h">257</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L257">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $coderef, $description ) = @_;</td></tr>
<tr><td class="h">258</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $exception = _try_as_caller( $coderef );</td></tr>
<tr><td class="h">259</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = $Tester-&gt;ok( _is_exception($exception), $description );</td></tr>
<tr><td class="h">260</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ = $exception;</td></tr>
<tr><td class="h">261</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">262</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">263</td><td colspan="6"></td></tr><tr><td class="h">264</td><td colspan="6"></td></tr><tr><td class="h">265 - 293</td><td colspan="5"></td><td class="s"><pre>=item B&lt;lives_ok&gt;

Checks that a piece of code doesn&#39;t die. This allows your test script to continue, rather than aborting if you get an unexpected exception. For example:

&nbsp;&nbsp;&nbsp;&nbsp;sub read_file {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $file = shift;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $/;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open my $fh, &#39;&lt;&#39;, $file or die &quot;open failed ($!)\n&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file = &lt;FILE&gt;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $file;
&nbsp;&nbsp;&nbsp;&nbsp;};

&nbsp;&nbsp;&nbsp;&nbsp;my $file;
&nbsp;&nbsp;&nbsp;&nbsp;lives_ok { $file = read_file(&#39;test.txt&#39;) } &#39;file read&#39;;

&nbsp;&nbsp;&nbsp;&nbsp;# or if you don&#39;t like prototypes
&nbsp;&nbsp;&nbsp;&nbsp;lives_ok( sub { $file = read_file(&#39;test.txt&#39;) }, &#39;file read&#39; );

Should a lives_ok() test fail it produces appropriate diagnostic messages. For example:

&nbsp;&nbsp;&nbsp;&nbsp;not ok 1 - file read
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Failed test (test.t at line 15)
&nbsp;&nbsp;&nbsp;&nbsp;# died: open failed (No such file or directory)

A true value is returned if the test succeeds, false otherwise. On exit $@ is guaranteed to be the cause of death (if any).

The test description is optional, but recommended. 

=cut</pre></td></tr>
<tr><td class="h">294</td><td colspan="6"></td></tr><tr><td class="h">295</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub lives_ok (&amp;;$) {</td></tr>
<tr><td class="h">296</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L296">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $coderef, $description ) = @_;</td></tr>
<tr><td class="h">297</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $exception = _try_as_caller( $coderef );</td></tr>
<tr><td class="h">298</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ok = $Tester-&gt;ok( ! _is_exception( $exception ), $description );</td></tr>
<tr><td class="h">299</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L299">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( _exception_as_string( &quot;died:&quot;, $exception ) ) unless $ok;</td></tr>
<tr><td class="h">300</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ = $exception;</td></tr>
<tr><td class="h">301</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ok;</td></tr>
<tr><td class="h">302</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">303</td><td colspan="6"></td></tr><tr><td class="h">304</td><td colspan="6"></td></tr><tr><td class="h">305 - 333</td><td colspan="5"></td><td class="s"><pre>=item B&lt;lives_and&gt;

Run a test that may throw an exception. For example, instead of doing:

&nbsp;&nbsp;my $file;
&nbsp;&nbsp;lives_ok { $file = read_file(&#39;answer.txt&#39;) } &#39;read_file worked&#39;;
&nbsp;&nbsp;is $file, &quot;42&quot;, &#39;answer was 42&#39;;

You can use lives_and() like this:

&nbsp;&nbsp;lives_and { is read_file(&#39;answer.txt&#39;), &quot;42&quot; } &#39;answer is 42&#39;;
&nbsp;&nbsp;# or if you don&#39;t like prototypes
&nbsp;&nbsp;lives_and(sub {is read_file(&#39;answer.txt&#39;), &quot;42&quot;}, &#39;answer is 42&#39;);

Which is the same as doing

&nbsp;&nbsp;is read_file(&#39;answer.txt&#39;), &quot;42\n&quot;, &#39;answer is 42&#39;;

unless C&lt;read_file(&#39;answer.txt&#39;)&gt; dies, in which case you get the same kind of error as lives_ok()

&nbsp;&nbsp;not ok 1 - answer is 42
&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Failed test (test.t at line 15)
&nbsp;&nbsp;# died: open failed (No such file or directory)

A true value is returned if the test succeeds, false otherwise. On exit $@ is guaranteed to be the cause of death (if any).

The test description is optional, but recommended.

=cut</pre></td></tr>
<tr><td class="h">334</td><td colspan="6"></td></tr><tr><td class="h">335</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub lives_and (&amp;;$) {</td></tr>
<tr><td class="h">336</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L336">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $test, $description ) = @_;</td></tr>
<tr><td class="h">337</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">338</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $Test::Builder::Level = $Test::Builder::Level + 1;</td></tr>
<tr><td class="h">339</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ok = \&amp;Test::Builder::ok;</td></tr>
<tr><td class="h">340</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L340">6</a></div></td><td><div>15</div><div>4</div><div>204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no warnings;</td></tr>
<tr><td class="h">341</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local *Test::Builder::ok = sub {</td></tr>
<tr><td class="h">342</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L342">0</a></div></td><td></td><td><div class="c0"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L342">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_[2] = $description unless defined $_[2];</td></tr>
<tr><td class="h">343</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok-&gt;(@_);</td></tr>
<tr><td class="h">344</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">345</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="local-lib-perl5-Test-Exception-pm--subroutine.html#L345">6</a></div></td><td><div>13</div><div>7</div><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use warnings;</td></tr>
<tr><td class="h">346</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L346">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval { $test-&gt;() } and return 1;</td></tr>
<tr><td class="h">347</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">348</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $exception = $@;</td></tr>
<tr><td class="h">349</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="local-lib-perl5-Test-Exception-pm--branch.html#L349">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( _is_exception( $exception ) ) {</td></tr>
<tr><td class="h">350</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;ok( 0, $description );</td></tr>
<tr><td class="h">351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Tester-&gt;diag( _exception_as_string( &quot;died:&quot;, $exception ) );</td></tr>
<tr><td class="h">352</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">353</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ = $exception;</td></tr>
<tr><td class="h">354</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">355</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">356</td><td colspan="6"></td></tr><tr><td class="h">357</td><td></td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h">358</td><td colspan="6"></td></tr><tr><td class="h">359</td><td colspan="6"></td></tr><tr><td class="h">360 - 502</td><td colspan="5"></td><td class="s"><pre>=head1 SKIPPING TEST::EXCEPTION TESTS

Sometimes we want to use Test::Exception tests in a test suite, but don&#39;t want to force the user to have Test::Exception installed. One way to do this is to skip the tests if Test::Exception is absent. You can do this with code something like this:

&nbsp;&nbsp;use strict;
&nbsp;&nbsp;use warnings;
&nbsp;&nbsp;use Test::More;
&nbsp;&nbsp;
&nbsp;&nbsp;BEGIN {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;use Test::Exception&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plan skip_all =&gt; &quot;Test::Exception needed&quot; if $@;
&nbsp;&nbsp;}
&nbsp;&nbsp;
&nbsp;&nbsp;plan tests =&gt; 2;
&nbsp;&nbsp;# ... tests that need Test::Exception ...

Note that we load Test::Exception in a C&lt;BEGIN&gt; block ensuring that the subroutine prototypes are in place before the rest of the test script is compiled.


=head1 BUGS

There are some edge cases in Perl&#39;s exception handling where Test::Exception will miss exceptions
thrown in DESTROY blocks. See the RT bug L&lt;http://rt.cpan.org/Ticket/Display.html?id=24678&gt; for
details, along with the t/edge-cases.t in the distribution test suite. These will be addressed in
a future Test::Exception release.

If you find any more bugs please let me know by e-mail, or report the problem with 
L&lt;http://rt.cpan.org/&gt;.


=head1 COMMUNITY

=over 4

=item perl-qa

If you are interested in testing using Perl I recommend you visit L&lt;http://qa.perl.org/&gt; and join the excellent perl-qa mailing list. See L&lt;http://lists.perl.org/showlist.cgi?name=perl-qa&gt; for details on how to subscribe.

=item perlmonks

You can find users of Test::Exception, including the module author, on&nbsp;&nbsp;L&lt;http://www.perlmonks.org/&gt;. Feel free to ask questions on Test::Exception there.

=item CPAN::Forum

The CPAN Forum is a web forum for discussing Perl&#39;s CPAN modules.&nbsp;&nbsp;&nbsp;The Test::Exception forum can be found at L&lt;http://www.cpanforum.com/dist/Test-Exception&gt;.

=item AnnoCPAN

AnnoCPAN is a web site that allows community annotations of Perl module documentation. The Test::Exception annotations can be found at L&lt;http://annocpan.org/~ADIE/Test-Exception/&gt;.

=back


=head1 TO DO

If you think this module should do something that it doesn&#39;t (or does something that it shouldn&#39;t) please let me know.

You can see my current to do list at L&lt;http://adrianh.tadalist.com/lists/public/15421&gt;, with an RSS feed of changes at L&lt;http://adrianh.tadalist.com/lists/feed_public/15421&gt;.


=head1 ACKNOWLEDGMENTS

Thanks to chromatic and Michael G Schwern for the excellent Test::Builder, without which this module wouldn&#39;t be possible.

Thanks to 
Adam Kennedy,
Andy Lester, 
Aristotle Pagaltzis, 
Ben Prew, 
Cees Hek,
Chris Dolan,
chromatic, 
Curt Sampson,
David Cantrell,
David Golden, 
David Tulloh,
David Wheeler, 
J. K. O&#39;Brien,
Janek Schleicher,
Jim Keenan, 
Jos I. Boumans, 
Joshua ben Jore,
Jost Krieger,
Mark Fowler, 
Michael G Schwern, 
Nadim Khemir,
Paul McCann,
Perrin Harkins, 
Peter Rabbitson,
Peter Scott, 
Ricardo Signes,
Rob Muhlestein,
Scott R. Godin,
Steve Purkis,
Steve, 
Tim Bunce,
and various anonymous folk for comments, suggestions, bug reports and patches.

=head1 AUTHOR

Adrian Howard &lt;adrianh@quietstars.com&gt;

If you can spare the time, please drop me a line if you find this module useful.


=head1 SEE ALSO

=over 4

=item L&lt;http://del.icio.us/tag/Test::Exception&gt;

Delicious links on Test::Exception.

=item L&lt;Test::Warn&gt; &amp; L&lt;Test::NoWarnings&gt;

Modules to help test warnings.

=item L&lt;Test::Builder&gt;

Support module for building test libraries.

=item L&lt;Test::Simple&gt; &amp; L&lt;Test::More&gt;

Basic utilities for writing tests.

=item L&lt;http://qa.perl.org/test-modules.html&gt;

Overview of some of the many testing modules available on CPAN.

=item L&lt;http://del.icio.us/tag/perl+testing&gt;

Delicious links on perl testing.

=back


=head1 LICENCE

Copyright 2002-2007 Adrian Howard, All Rights Reserved.

This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.

=cut</pre></td></tr>
<tr><td class="h">503</td><td colspan="6"></td></tr><tr><td class="h">504</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
